<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Finanzielle Souver√§nit√§t ‚Äì Landingpage</title>
<meta name="color-scheme" content="dark light" />
<style>
  :root{
    --cloud: rgba(20,22,28,0.70);             /* ‚ÄûWolken‚Äú-Fl√§che */
    --cloud-strong: rgba(20,22,28,0.82);
    --text: #f1f5f9;
    --muted:#cbd5e1;
    --accent:#facc15;                          /* Goldgelb */
    --mint:#00c2a7;                            /* T√ºrkis-Akzent */
    --glow: 0 0 40px rgba(250,204,21,.35), 0 0 12px rgba(250,204,21,.25);
    --glow-soft: 0 0 24px rgba(250,204,21,.22);
    --radius: 16px;
    --shadow: 0 18px 60px rgba(0,0,0,.55);
    --maxw: 1200px;
  }

  html,body{height:100%;margin:0}
  body{
    font-family: Inter, Segoe UI, Roboto, system-ui, -apple-system, Arial, sans-serif;
    color: var(--text);
    background: #000; overflow-x:hidden;
  }

  /* ===== Adler-Video: immer im Hintergrund ===== */
  .bg{
    position:fixed; inset:0; z-index:-2; overflow:hidden;
    background:#000;
  }
  .bg video, .bg iframe{
    position:absolute; inset:0; width:100%; height:100%;
    object-fit:cover; border:0;
  }
  /* Rotator-Overlay (falls aktiv) ersetzt den Hintergrund-Clip */
  #rotatorFrame{ display:none; }

  /* ===== Top-Men√º (schwebende Buttons, Position wie Vorbild) ===== */
  .topbar{
    position:sticky; top:0; z-index:5;
    display:flex; justify-content:center; gap:18px;
    padding:14px 10px;
    background:linear-gradient(to bottom, rgba(0,0,0,.65), rgba(0,0,0,.15) 60%, transparent);
    backdrop-filter: blur(6px);
  }
  .toplink{
    color:#fff; text-decoration:none; font-weight:700; font-size:15px;
    padding:10px 16px; border-radius:999px;
    background: rgba(0,0,0,.55);
    border:1px solid rgba(255,255,255,.08);
    box-shadow: var(--glow-soft);
    transition: transform .15s ease, background .2s ease, box-shadow .2s ease;
  }
  .toplink:hover{ transform: translateY(-1px); background:rgba(0,0,0,.7); box-shadow: var(--glow); }

  /* ===== Sektionen / Karten mit ‚ÄûWolken‚Äú-Glas + Glow ===== */
  section{ padding:56px 16px; }
  .wrap{ max-width:var(--maxw); margin:0 auto; }
  .grid2{ display:grid; grid-template-columns:1fr 1fr; gap:28px; }
  @media (max-width:960px){ .grid2{ grid-template-columns:1fr; } }

  .card{
    background: var(--cloud);
    backdrop-filter: blur(12px);
    border-radius: var(--radius);
    padding: 28px;
    box-shadow: var(--shadow), var(--glow-soft);
    border: 1px solid rgba(255,255,255,.06);
  }
  .cloud-strong{ background: var(--cloud-strong); }

  h1,h2,h3{ margin:0 0 14px; font-weight:800; line-height:1.15; }
  h1 .mint{ color: var(--mint); }

  .lead{ color: var(--muted); line-height:1.7; }

  .quote{
    font-style: italic; text-align:center; color:#e5e7eb;
  }

  .btn{
    display:inline-flex; align-items:center; justify-content:center;
    gap:10px; padding:12px 22px;
    background: var(--accent); color:#111; font-weight:800; border:0;
    border-radius: 999px; cursor:pointer; text-decoration:none;
    box-shadow: 0 10px 24px rgba(250,204,21,.25);
    transition: transform .15s ease, filter .2s ease;
  }
  .btn:hover{ transform: translateY(-1px); filter:brightness(1.05); }

  /* ===== Kino-Fenster (leer, wird extern bespielt) ===== */
  .kinoShell{
    margin-top: 22px;
    border-radius: var(--radius);
    border:1px solid rgba(255,255,255,.08);
    box-shadow: var(--shadow), var(--glow);
    padding: 12px;
    background: linear-gradient(to bottom, rgba(0,0,0,.25), rgba(0,0,0,.15));
  }
  .kinoViewport{
    border-radius: 14px;
    height: 52vh; min-height: 360px;
    background: radial-gradient(ellipse at 30% 20%, rgba(255,255,255,.08), rgba(0,0,0,.35) 60%, rgba(0,0,0,.55));
    backdrop-filter: blur(10px);
  }

  /* ===== CTA ===== */
  .ctaBox{ max-width: 780px; margin:0 auto; text-align:center; }

  /* ===== Musik-Button unten rechts ===== */
  #musicToggle{
    position: fixed; right: 20px; bottom: 20px; z-index: 6;
    background: rgba(0,0,0,.65); border:1px solid rgba(255,255,255,.08);
    color:#fff; padding:12px 16px; border-radius:999px;
    box-shadow: var(--glow-soft); backdrop-filter: blur(8px);
    cursor:pointer; font-weight:700;
  }

  /* ===== Begr√º√üungs-Overlay ===== */
  .overlay{
    position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
    background: radial-gradient(circle at 50% 30%, rgba(0,0,0,.35), rgba(0,0,0,.85));
    z-index: 8; padding:16px;
  }
  .welcome{
    width:min(680px, 96vw);
    background: var(--cloud-strong); border-radius: 18px;
    border:1px solid rgba(255,255,255,.08);
    box-shadow: var(--shadow), var(--glow);
    padding: 26px 22px;
    text-align:center;
  }
  .welcome h3{ margin:6px 0 10px; font-size: 1.6rem; }
  .welcome p{ margin: 4px 0; color: var(--muted); }
  .welcome .row{ display:flex; gap:10px; margin-top:14px; }
  .welcome input{
    flex:1; min-width:200px; padding:12px 14px; border-radius:10px;
    border:1px solid rgba(255,255,255,.15); background: rgba(0,0,0,.35);
    color:#fff; font-weight:600;
  }
  .welcome small{ display:block; margin-top:10px; color: var(--muted); }

  /* sanfter Auftritt */
  .fade-in{ animation:fade .5s ease both; }
  @keyframes fade{ from{opacity:0; transform: translateY(6px)} to{opacity:1; transform:none} }

  footer{
    padding: 40px 16px; text-align:center; color: var(--muted);
  }
  .divider{
    opacity:.7; margin:20px auto; max-width:920px; height:1px;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,.25), transparent);
  }
</style>
</head>
<body>

<!-- ===== Hintergrund: Adler Loop (Fallback) + optionaler Rotator ===== -->
<div class="bg" aria-hidden="true">
  <!-- Rotator: wird per JS sichtbar, wenn aktiv -->
  <iframe id="rotatorFrame" title="Rotator" allow="autoplay; fullscreen"></iframe>

  <!-- Fallback Adler (lokal / YouTube ‚Äì hier YouTube als sichere Quelle) -->
  <iframe
    id="eagleBg"
    title="Adler-Loop"
    src="https://www.youtube.com/embed/miWBKSszEIw?autoplay=1&mute=1&loop=1&playlist=miWBKSszEIw&controls=0&modestbranding=1&playsinline=1"
    allow="autoplay; fullscreen"
  ></iframe>
</div>

<!-- ===== Autoplay Musik (mit Fallback) ===== -->
<audio id="bgMusic" preload="auto" loop>
  <!-- Deine MP3 aus dem Repo (Template 002) -->
  <source src="https://adler-fsa.github.io/FSA-Admin/media/loop-theme.mp3" type="audio/mpeg" />
</audio>
<button id="musicToggle">üéµ Musik starten</button>

<!-- ===== Schwebende Men√º-Buttons (genau die Ziel-Links) ===== -->
<nav class="topbar">
  <a class="toplink" href="https://www.finanziellesouveraenitaet.de/startseite" target="_blank" rel="noopener">Startseite</a>
  <a class="toplink" href="https://www.finanziellesouveraenitaet.de/campus" target="_blank" rel="noopener">Campus</a>
  <a class="toplink" href="https://www.finanziellesouveraenitaet.de/grundkurs-anfaenger" target="_blank" rel="noopener">Grundkurs/Anf√§nger</a>
  <a class="toplink" href="https://www.finanziellesouveraenitaet.de/onboarding" target="_blank" rel="noopener">Onboarding</a>
  <a class="toplink" href="https://www.finanziellesouveraenitaet.de/krypto-glossar-pro" target="_blank" rel="noopener">Krypto-Glossar Pro</a>
</nav>

<!-- ===== Hero-Bl√∂cke wie im Original ===== -->
<section>
  <div class="wrap grid2 fade-in">
    <div class="card cloud-strong">
      <h1>Dein Geld.<br><span class="mint">Deine Freiheit.</span></h1>
      <p class="lead">Die Welt ver√§ndert sich: Inflation, KI, Blockchain. Hier lernst du, wie du souver√§n wirst.</p>
      <p><strong>Nie mehr Fremdbestimmung.</strong></p>
      <p>Wer es wirklich will, folgt der Einladung. Viele Tausende entdecken jeden Tag die Krypto-Welt.</p>
      <p>Viele haben Angst ‚Äì weil sie eben keine Ahnung haben. Genau deshalb gibt es die <strong>Finanzielle Souver√§nit√§t Online Akademie</strong>.</p>
      <a href="#cta" class="btn">Jetzt starten</a>
    </div>

    <div class="card quote">‚ÄûEine Investition in Wissen bringt die besten Zinsen.‚Äú ‚Äì Franklin</div>

    <div class="card cloud-strong">
      <h2>Deine Vorteile</h2>
      <ul style="line-height:1.9; padding-left: 1.2rem; margin: 10px 0 6px">
        <li>üí∞ Verm√∂gen sch√ºtzen</li>
        <li>üîë Zugang zu Krypto</li>
        <li>ü§ñ Einkommen mit KI</li>
        <li>üåê Klarheit statt Chaos</li>
      </ul>
      <p class="lead" style="text-align:center;margin-top:10px">All das bekommst du schon im kostenlosen Grundkurs.</p>
    </div>

    <div class="card quote">‚ÄûDas Wichtigste ist, in dich selbst zu investieren.‚Äú ‚Äì Buffett</div>
  </div>
</section>

<!-- ===== Dein Digitaler Mentor ===== -->
<section>
  <div class="wrap fade-in">
    <div class="card cloud-strong" style="text-align:center">
      <h2>Dein Digitaler Mentor</h2>
      <p class="lead">Dein pers√∂nlicher Begleiter durch die Akademie: Er zeigt dir Schritt f√ºr Schritt, wie du √Ñngste √ºberwindest, Wissen aufbaust und souver√§n in der neuen Welt bestehst.</p>
    </div>
  </div>
</section>

<!-- ===== Reise (als aufklappfreie, saubere Liste ‚Äì Zeilen umbrechen sch√∂n) ===== -->
<section>
  <div class="wrap fade-in">
    <div class="card cloud-strong">
      <h2>Deine Reise zur finanziellen Souver√§nit√§t</h2>
      <div style="height:8px"></div>
      <div class="lead">üöÄ Nie mehr Fremdbestimmung</div>
      <p class="lead" style="margin-top:6px">Starte deinen eigenen Weg. Wer losgeht, entdeckt die Chancen, die in Blockchain, KI und Krypto stecken.</p>
      <hr class="divider" />
      <div class="lead">üéÜ Wer es wirklich will, folgt der Einladung</div>
      <p class="lead" style="margin-top:6px">Du bist nicht allein ‚Äì viele Menschen gehen diesen Weg. Die Community w√§chst t√§glich.</p>
      <hr class="divider" />
      <div class="lead">üß† Viele Tausende entdecken t√§glich die Krypto-Welt</div>
      <p class="lead" style="margin-top:6px">Die Zukunft ist digital. Blockchain, Krypto und KI er√∂ffnen dir neue Einkommensm√∂glichkeiten.</p>
      <hr class="divider" />
      <div class="lead">üò® Angst entsteht aus Unwissenheit</div>
      <p class="lead" style="margin-top:6px">Wissen schafft Sicherheit. Genau deshalb gibt es diesen Kurs.</p>
      <hr class="divider" />
      <div class="lead">üìö Deshalb gibt es die Akademie</div>
      <p class="lead" style="margin-top:6px">Hier bekommst du alles, was du brauchst: Klarheit, Praxiswissen und die Tools f√ºr deine Freiheit.</p>
    </div>
  </div>
</section>

<!-- ===== Kino-Fenster (leer, wird √ºber media-admin gesteuert) ===== -->
<section>
  <div class="wrap fade-in">
    <div class="card" style="background:transparent; box-shadow: var(--glow);">
      <div class="kinoShell">
        <div class="kinoViewport" id="kino"></div>
      </div>
    </div>
  </div>
</section>

<!-- ===== CTA mit leerem E-Mail-Platzhalter ===== -->
<section id="cta">
  <div class="wrap fade-in">
    <div class="card cloud-strong ctaBox" style="padding:42px 30px">
      <h2 style="font-size:2rem;margin-bottom:10px">Finanzbildung f√ºr die neue Welt</h2>
      <p style="font-size:1.15rem; color:var(--mint); font-weight:800; letter-spacing:.2px">Dein Geld. Deine Zukunft. Deine Souver√§nit√§t.</p>

      <a href="mailto:EMAIL_PLACEHOLDER" class="btn" style="width:100%; max-width:560px; margin:20px auto 6px; display:inline-flex">
        üöÄ Jetzt kostenlos starten ‚Äì EMAIL_PLACEHOLDER
      </a>

      <p class="lead" style="margin-top:14px; font-size:1rem">Oder kopiere die Adresse direkt:</p>
      <p style="font-size:1.2rem; font-weight:800; color:var(--accent); letter-spacing:.3px">EMAIL_PLACEHOLDER</p>
      <button class="btn" onclick="navigator.clipboard.writeText('EMAIL_PLACEHOLDER').then(()=>alert('üìã E-Mail kopiert: EMAIL_PLACEHOLDER'))">üìã E-Mail kopieren</button>

      <p class="lead" style="margin-top:16px">üëâ √úber diese E-Mail erh√§ltst du direkten Kontakt zu einem menschlichen Mentor, der die Akademie bereits erfolgreich abgeschlossen hat.</p>
      <p class="lead" style="margin-top:8px; color:var(--mint); font-weight:800">‚úÖ Von deinem Mentor erh√§ltst du au√üerdem deine pers√∂nlichen Zugangsdaten zum Grundkurs.</p>
    </div>
  </div>
</section>

<footer>
  <div class="divider"></div>
  <div>‚ÄûWissen ist Macht ‚Äì angewandtes Wissen ist Freiheit.‚Äú</div>
  <div style="opacity:.6; margin-top:8px">¬© 2025 Finanzielle Souver√§nit√§ts Akademie</div>
</footer>

<!-- ===== Begr√º√üung / Aktivierung ===== -->
<div class="overlay" id="welcome">
  <div class="welcome">
    <h3>Willkommen! ü¶Ö</h3>
    <p>Aktiviere jetzt deine pers√∂nliche Landingpage.</p>
    <p><strong>Gib deine eigene seri√∂se E-Mail</strong> ein. Sie wird fest mit dieser Seite verbunden.</p>

    <div class="row">
      <input id="inEmail" type="email" inputmode="email" autocomplete="email" placeholder="dein.name@mail.de" />
      <button id="btnActivate" class="btn">‚úÖ Freischalten</button>
      <button id="btnLater" class="btn" style="background:#374151; color:#fff">‚è≥ Sp√§ter ansehen</button>
    </div>
    <small>Du kannst die Seite auch erst in Ruhe ansehen und sp√§ter die E-Mail eintragen.</small>

    <div id="welcomeMsg" style="margin-top:10px; font-weight:700"></div>
  </div>
</div>

<script>
(function(){
  /* =======================
     Konstanten / Parameter
  ======================= */
  const ADMIN_REPO_OWNER = "Adler-FSA";
  const ADMIN_REPO = "FSA-Admin";
  const EMAILS_PATH = "data/emails.json";
  const LEDGER_PATH = "data/ledger.json";
  const ROTATOR_URL = "https://adler-fsa.github.io/FSA-Admin/rotator.json"; // { active: true, url: "https://..." }

  const qs = new URLSearchParams(location.search);
  const lpId = qs.get("id") || "";            // z.B. FSA-2025-10-02-0001
  const ghToken = qs.get("token") || "";      // optional: PAT in URL (nur Admin/Bridge)
  const apiRoot = `https://api.github.com/repos/${ADMIN_REPO_OWNER}/${ADMIN_REPO}/contents/`;

  const welcome = document.getElementById("welcome");
  const inEmail = document.getElementById("inEmail");
  const btnActivate = document.getElementById("btnActivate");
  const btnLater = document.getElementById("btnLater");
  const msg = document.getElementById("welcomeMsg");

  /* =======================
     Musik sofort starten
  ======================= */
  const audio = document.getElementById("bgMusic");
  const toggle = document.getElementById("musicToggle");

  function setMusicBtn(on){
    toggle.textContent = on ? "üîá Musik ausschalten" : "üéµ Musik starten";
  }
  async function startMusicAutoplay(){
    try{
      await audio.play();
      setMusicBtn(true);
    }catch(e){
      // Autoplay blockiert ‚Üí Button bleibt ‚ÄûMusik starten‚Äú
      setMusicBtn(false);
    }
  }
  toggle.addEventListener("click", async ()=>{
    if(audio.paused){ try{ await audio.play(); setMusicBtn(true);}catch(e){} }
    else { audio.pause(); setMusicBtn(false); }
  });

  /* =======================
     Rotator pr√ºfen
  ======================= */
  async function applyRotator(){
    try{
      const res = await fetch(ROTATOR_URL, {cache:"no-store"});
      if(!res.ok) return;
      const data = await res.json(); // {active:boolean, url:"..."} (z.B. YouTube-URL/Embed URL)
      const rot = document.getElementById("rotatorFrame");
      const eagle = document.getElementById("eagleBg");
      if(data && data.active && data.url){
        // Minimal robust: Wenn rohes YouTube-URL ‚Üí in Embed wandeln
        let url = data.url;
        if(url.includes("youtube.com/watch") || url.includes("youtu.be/")){
          const id = url.split("v=")[1]?.split("&")[0] || url.split("/").pop();
          url = `https://www.youtube.com/embed/${id}?autoplay=1&mute=1&loop=1&playlist=${id}&controls=0&modestbranding=1&playsinline=1`;
        }
        rot.src = url; rot.style.display = "block"; eagle.style.display="none";
      }else{
        // zur√ºck auf Adler
        document.getElementById("rotatorFrame").style.display="none";
        document.getElementById("eagleBg").style.display="block";
      }
    }catch(e){}
  }

  /* =======================
     Emails/Ledger lesen
  ======================= */
  async function fetchJsonFromPages(path){
    const url = `https://${ADMIN_REPO_OWNER.toLowerCase()}.github.io/${ADMIN_REPO}/${path}`;
    const r = await fetch(url, {cache:"no-store"});
    if(!r.ok) throw new Error("fetch failed: "+path);
    return r.json();
  }

  function validEmail(v){
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v||"");
  }

  /* =======================
     GitHub write helper (optional)
  ======================= */
  async function ghGetFile(path){
    const r = await fetch(apiRoot+path, { headers: ghToken ? {Authorization: `Bearer ${ghToken}`} : {}});
    if(!r.ok) throw new Error("GET file failed");
    return r.json(); // { content(base64), sha, ... }
  }
  async function ghPutFile(path, content, sha, message){
    const body = {
      message,
      content: btoa(unescape(encodeURIComponent(content))),
      sha
    };
    const r = await fetch(apiRoot+path, {
      method:"PUT",
      headers:{
        "Content-Type":"application/json",
        ...(ghToken ? {Authorization:`Bearer ${ghToken}`} : {})
      },
      body: JSON.stringify(body)
    });
    if(!r.ok) throw new Error("PUT file failed");
    return r.json();
  }

  async function activateEmailThroughGitHub(newEmail){
    // 1) emails.json
    const emails = await ghGetFile(EMAILS_PATH);
    const emailsJson = JSON.parse(atob(emails.content));
    emailsJson[lpId] = { email: newEmail, mode: "live", created_at: new Date().toISOString() };
    await ghPutFile(EMAILS_PATH, JSON.stringify(emailsJson, null, 2), emails.sha, `LP ${lpId}: set email & live`);

    // 2) ledger.json
    const ledger = await ghGetFile(LEDGER_PATH);
    const ledgerArr = JSON.parse(atob(ledger.content));
    const idx = ledgerArr.findIndex(x => x.id === lpId);
    const entry = { id: lpId, email: newEmail, mode: "live", url: location.href, created_at: new Date().toISOString() };
    if(idx >= 0) ledgerArr[idx] = entry; else ledgerArr.push(entry);
    await ghPutFile(LEDGER_PATH, JSON.stringify(ledgerArr, null, 2), ledger.sha, `LP ${lpId}: ledger updated`);
  }

  function mailFallback(newEmail){
    const subj = encodeURIComponent("LP-Aktivierung (Bitte E-Mail setzen)");
    const body = encodeURIComponent([
      `Hallo Admin,`,
      ``,
      `bitte die folgende LP aktivieren:`,
      `‚Ä¢ ID: ${lpId || "(keine ID in URL)"}`,
      `‚Ä¢ E-Mail: ${newEmail}`,
      `‚Ä¢ LP-URL: ${location.href}`,
      ``,
      `Danke!`
    ].join("\n"));
    window.location.href = `mailto:info@finanziellesouveraenitaet.de?subject=${subj}&body=${body}`;
  }

  /* =======================
     Begr√º√üung / Modus-Steuerung
  ======================= */
  async function decideWelcome(){
    // Wenn keine ID, dann zeige Welcome (Partner-Version)
    let mode = "setup";
    let linkedEmail = null;
    try{
      const emails = await fetchJsonFromPages(EMAILS_PATH);
      const ledger = await fetchJsonFromPages(LEDGER_PATH);
      if(lpId){
        const e = emails[lpId];
        if(e){ mode = e.mode || "setup"; linkedEmail = e.email || null; }
        else{
          // ggf. ledger pr√ºfen
          const row = (ledger||[]).find(x=>x.id===lpId);
          if(row){ mode = row.mode || "setup"; linkedEmail = row.email || null; }
        }
      }
    }catch(e){ /* wenn offline: bleibt setup */ }

    // Regel: Wenn live ‚Üí kein Begr√º√üungsfenster
    if(mode === "live" && linkedEmail){
      welcome.style.display="none";
    }else{
      // Setup: Begr√º√üung zeigen (Adler fliegt bereits dahinter)
      welcome.style.display="flex";
    }
  }

  btnLater.addEventListener("click", ()=> welcome.style.display="none");

  btnActivate.addEventListener("click", async ()=>{
    const v = inEmail.value.trim();
    msg.textContent = "";
    if(!validEmail(v)){
      msg.style.color = "#f87171";
      msg.textContent = "‚ö†Ô∏è Bitte eine g√ºltige E-Mail eingeben.";
      return;
    }

    // 1) Mit Token ‚Üí direkt committen
    if(ghToken && lpId){
      try{
        btnActivate.disabled = true;
        btnActivate.textContent = "‚è≥ Aktiviere‚Ä¶";
        await activateEmailThroughGitHub(v);
        msg.style.color = "#22c55e";
        msg.textContent = "‚úÖ Aktiviert! Die Seite ist jetzt im Live-Modus.";
        setTimeout(()=> welcome.style.display="none", 800);
      }catch(e){
        msg.style.color = "#f87171";
        msg.textContent = "‚ö†Ô∏è Aktivierung fehlgeschlagen. Fallback: Es wird eine E-Mail an den Admin vorbereitet‚Ä¶";
        setTimeout(()=> mailFallback(v), 600);
      }finally{
        btnActivate.disabled = false;
        btnActivate.textContent = "‚úÖ Freischalten";
      }
    }else{
      // 2) Ohne Token ‚Üí Admin-Mail ansto√üen
      mailFallback(v);
    }
  });

  /* =======================
     Start
  ======================= */
  startMusicAutoplay();
  applyRotator();
  decideWelcome();
})();
</script>
</body>
</html>
